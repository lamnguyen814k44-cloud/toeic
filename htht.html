<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEIC Present Perfect Continuous - Interactive Quiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .header h1 {
            color: #1e3c72;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .progress-container {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .quiz-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .level-badge {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .level-basic {
            background: #E3F2FD;
            color: #1976D2;
        }

        .level-intermediate {
            background: #FFF3E0;
            color: #F57C00;
        }

        .level-advanced {
            background: #FCE4EC;
            color: #C2185B;
        }

        .question {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #222;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 18px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 16px;
        }

        .option:hover:not(.selected):not(.disabled) {
            border-color: #2a5298;
            background: #f5f9ff;
            transform: translateX(5px);
        }

        .option.selected {
            cursor: default;
        }

        .option.correct {
            border-color: #4CAF50;
            background: #E8F5E9;
        }

        .option.incorrect {
            border-color: #f44336;
            background: #FFEBEE;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .explanation {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            display: none;
            animation: slideDown 0.4s ease;
        }

        .explanation.show {
            display: block;
        }

        .explanation.correct-explanation {
            background: #E8F5E9;
            border-left: 4px solid #4CAF50;
        }

        .explanation.incorrect-explanation {
            background: #FFEBEE;
            border-left: 4px solid #f44336;
        }

        .explanation h3 {
            margin-bottom: 10px;
            font-size: 18px;
        }

        .explanation p {
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .why-wrong {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .why-wrong h4 {
            font-size: 14px;
            margin-bottom: 8px;
            color: #666;
        }

        .why-wrong ul {
            list-style: none;
            padding-left: 0;
        }

        .why-wrong li {
            padding: 6px 0;
            font-size: 14px;
            color: #555;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .nav-button {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .prev-button {
            background: #757575;
            color: white;
        }

        .prev-button:hover:not(:disabled) {
            background: #616161;
            transform: translateY(-2px);
        }

        .next-button {
            background: #2a5298;
            color: white;
        }

        .next-button:hover:not(:disabled) {
            background: #1e3c72;
            transform: translateY(-2px);
        }

        .finish-button {
            background: #4CAF50;
            color: white;
        }

        .finish-button:hover {
            background: #43A047;
            transform: translateY(-2px);
        }

        .result-screen {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            text-align: center;
            display: none;
        }

        .result-screen.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .score-circle {
            width: 180px;
            height: 180px;
            margin: 30px auto;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            color: white;
        }

        .score-excellent {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
        }

        .score-good {
            background: linear-gradient(135deg, #2196F3, #03A9F4);
        }

        .score-fair {
            background: linear-gradient(135deg, #FF9800, #FFC107);
        }

        .score-poor {
            background: linear-gradient(135deg, #f44336, #E91E63);
        }

        .restart-button {
            margin-top: 30px;
            padding: 15px 40px;
            background: #2a5298;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-button:hover {
            background: #1e3c72;
            transform: translateY(-2px);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 22px;
            }
            
            .quiz-card {
                padding: 20px;
            }
            
            .question {
                font-size: 16px;
            }
            
            .option {
                padding: 15px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ TOEIC Present Perfect Continuous Quiz</h1>
            <p>M·ª•c ti√™u: 950+ | 30 c√¢u t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao</p>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">C√¢u 1/30</div>
        </div>

        <div class="quiz-card" id="quizCard">
            <div class="level-badge" id="levelBadge"></div>
            <div class="question" id="question"></div>
            <div class="options" id="options"></div>
            <div class="explanation" id="explanation"></div>
        </div>

        <div class="navigation">
            <button class="nav-button prev-button" id="prevBtn" onclick="previousQuestion()">‚Üê C√¢u tr∆∞·ªõc</button>
            <button class="nav-button next-button" id="nextBtn" onclick="nextQuestion()">C√¢u sau ‚Üí</button>
        </div>

        <div class="result-screen" id="resultScreen">
            <h2>üéâ Ho√†n th√†nh!</h2>
            <div class="score-circle" id="scoreCircle">
                <span id="scoreText"></span>
            </div>
            <h3 id="resultMessage"></h3>
            <p id="resultDetail"></p>
            <button class="restart-button" onclick="restartQuiz()">üîÑ L√†m l·∫°i</button>
        </div>
    </div>

    <script>
        const questions = [
            {
                level: "Basic",
                question: "The company ________ a new marketing strategy for the past three months.",
                options: [
                    "A. has been developing",
                    "B. has developed",
                    "C. was developing",
                    "D. develops"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been developing' (hi·ªán t·∫°i ho√†n th√†nh ti·∫øp di·ªÖn) di·ªÖn t·∫£ h√†nh ƒë·ªông b·∫Øt ƒë·∫ßu t·ª´ qu√° kh·ª©, k√©o d√†i li√™n t·ª•c ƒë·∫øn hi·ªán t·∫°i v√† nh·∫•n m·∫°nh s·ª± li√™n t·ª•c. C√≥ 'for the past three months' ch·ªâ kho·∫£ng th·ªùi gian k√©o d√†i.",
                whyWrong: [
                    "B. Has developed (hi·ªán t·∫°i ho√†n th√†nh): nh·∫•n m·∫°nh k·∫øt qu·∫£, kh√¥ng nh·∫•n m·∫°nh s·ª± li√™n t·ª•c trong su·ªët 3 th√°ng.",
                    "C. Was developing (qu√° kh·ª© ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra t·∫°i m·ªôt th·ªùi ƒëi·ªÉm trong qu√° kh·ª©, kh√¥ng li√™n h·ªá v·ªõi hi·ªán t·∫°i.",
                    "D. Develops (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen/s·ª± th·∫≠t, kh√¥ng ph√π h·ª£p v·ªõi kho·∫£ng th·ªùi gian 'for the past three months'."
                ]
            },
            {
                level: "Basic",
                question: "We ________ for the manager since 9 a.m., but he still hasn't arrived.",
                options: [
                    "A. have been waiting",
                    "B. waited",
                    "C. are waiting",
                    "D. wait"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been waiting' di·ªÖn t·∫£ h√†nh ƒë·ªông b·∫Øt ƒë·∫ßu t·ª´ 9 gi·ªù s√°ng, k√©o d√†i li√™n t·ª•c ƒë·∫øn hi·ªán t·∫°i (v·∫´n ƒëang ch·ªù). T·ª´ 'since' l√† d·∫•u hi·ªáu c·ªßa Present Perfect Continuous.",
                whyWrong: [
                    "B. Waited (qu√° kh·ª© ƒë∆°n): ch·ªâ h√†nh ƒë·ªông ƒë√£ ho√†n th√†nh trong qu√° kh·ª©, kh√¥ng li√™n quan ƒë·∫øn hi·ªán t·∫°i.",
                    "C. Are waiting (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra hi·ªán t·∫°i, kh√¥ng n√≥i l√™n kho·∫£ng th·ªùi gian ƒë√£ ch·ªù t·ª´ 9 gi·ªù s√°ng.",
                    "D. Wait (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng c·ª• th·ªÉ n√†y."
                ]
            },
            {
                level: "Basic",
                question: "She looks tired because she ________ on this report all day.",
                options: [
                    "A. has been working",
                    "B. worked",
                    "C. works",
                    "D. is working"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been working' gi·∫£i th√≠ch nguy√™n nh√¢n hi·ªán t·∫°i (tired) b·∫±ng h√†nh ƒë·ªông k√©o d√†i su·ªët c·∫£ ng√†y. Present Perfect Continuous th∆∞·ªùng d√πng ƒë·ªÉ gi·∫£i th√≠ch k·∫øt qu·∫£/h·∫≠u qu·∫£ ·ªü hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Worked (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi t√¨nh tr·∫°ng hi·ªán t·∫°i (looks tired now).",
                    "C. Works (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng gi·∫£i th√≠ch ƒë∆∞·ª£c t·∫°i sao b√¢y gi·ªù m·ªát.",
                    "D. Is working (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra, kh√¥ng n√≥i l√™n ƒë√£ l√†m vi·ªác 'all day'."
                ]
            },
            {
                level: "Basic",
                question: "How long ________ English before you moved to the US?",
                options: [
                    "A. had you been studying",
                    "B. have you been studying",
                    "C. did you study",
                    "D. are you studying"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Had you been studying' (qu√° kh·ª© ho√†n th√†nh ti·∫øp di·ªÖn) di·ªÖn t·∫£ h√†nh ƒë·ªông k√©o d√†i ƒë·∫øn m·ªôt m·ªëc trong qu√° kh·ª© (before you moved). C√¢u h·ªèi v·ªÅ kho·∫£ng th·ªùi gian tr∆∞·ªõc s·ª± ki·ªán qu√° kh·ª©.",
                whyWrong: [
                    "B. Have you been studying (hi·ªán t·∫°i ho√†n th√†nh ti·∫øp di·ªÖn): d√πng cho h√†nh ƒë·ªông li√™n quan ƒë·∫øn hi·ªán t·∫°i, kh√¥ng ph√π h·ª£p v√¨ ƒë√£ 'moved' (qu√° kh·ª©).",
                    "C. Did you study (qu√° kh·ª© ƒë∆°n): kh√¥ng nh·∫•n m·∫°nh s·ª± li√™n t·ª•c v√† kho·∫£ng th·ªùi gian 'how long'.",
                    "D. Are you studying (hi·ªán t·∫°i ti·∫øp di·ªÖn): d√πng cho hi·ªán t·∫°i, ho√†n to√†n sai ng·ªØ c·∫£nh qu√° kh·ª©."
                ]
            },
            {
                level: "Basic",
                question: "They ________ the new software for two weeks now.",
                options: [
                    "A. have been testing",
                    "B. tested",
                    "C. test",
                    "D. were testing"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been testing' v·ªõi 'for two weeks now' ch·ªâ h√†nh ƒë·ªông b·∫Øt ƒë·∫ßu 2 tu·∫ßn tr∆∞·ªõc, v·∫´n ti·∫øp di·ªÖn ƒë·∫øn hi·ªán t·∫°i. 'Now' nh·∫•n m·∫°nh li√™n h·ªá v·ªõi th·ªùi ƒëi·ªÉm n√≥i.",
                whyWrong: [
                    "B. Tested (qu√° kh·ª© ƒë∆°n): ch·ªâ h√†nh ƒë·ªông ƒë√£ ho√†n th√†nh, kh√¥ng c√≤n ti·∫øp di·ªÖn.",
                    "C. Test (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen chung, kh√¥ng ph√π h·ª£p v·ªõi kho·∫£ng th·ªùi gian c·ª• th·ªÉ.",
                    "D. Were testing (qu√° kh·ª© ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông trong qu√° kh·ª©, kh√¥ng li√™n quan ƒë·∫øn 'now'."
                ]
            },
            {
                level: "Basic",
                question: "I ________ to contact you all morning. Where have you been?",
                options: [
                    "A. have been trying",
                    "B. tried",
                    "C. try",
                    "D. was trying"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been trying' di·ªÖn t·∫£ n·ªó l·ª±c li√™n t·ª•c t·ª´ s√°ng ƒë·∫øn gi·ªù. 'All morning' l√† d·∫•u hi·ªáu c·ªßa Present Perfect Continuous, v√† c√¢u h·ªèi 'Where have you been?' x√°c nh·∫≠n th·ªùi ƒëi·ªÉm hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Tried (qu√° kh·ª© ƒë∆°n): ch·ªâ h√†nh ƒë·ªông ƒë√£ xong, kh√¥ng nh·∫•n m·∫°nh n·ªó l·ª±c li√™n t·ª•c 'all morning'.",
                    "C. Try (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng c·ª• th·ªÉ.",
                    "D. Was trying (qu√° kh·ª© ti·∫øp di·ªÖn): kh√¥ng li√™n k·∫øt v·ªõi hi·ªán t·∫°i (Where have you been?)."
                ]
            },
            {
                level: "Intermediate",
                question: "The sales team ________ consistently high results this quarter, which is why they received a bonus.",
                options: [
                    "A. has been achieving",
                    "B. has achieved",
                    "C. achieved",
                    "D. had been achieving"
                ],
                correct: 1,
                explanation: "ƒê√∫ng! 'Has achieved' (hi·ªán t·∫°i ho√†n th√†nh ƒë∆°n) nh·∫•n m·∫°nh K·∫æT QU·∫¢ (high results) ƒë√£ ƒë·∫°t ƒë∆∞·ª£c, d·∫´n ƒë·∫øn ph·∫ßn th∆∞·ªüng. Present Perfect Continuous nh·∫•n m·∫°nh qu√° tr√¨nh, nh∆∞ng ·ªü ƒë√¢y ta c·∫ßn nh·∫•n m·∫°nh th√†nh t√≠ch.",
                whyWrong: [
                    "A. Has been achieving: nh·∫•n m·∫°nh qu√° tr√¨nh li√™n t·ª•c h∆°n l√† k·∫øt qu·∫£ c·ª• th·ªÉ, √≠t ph√π h·ª£p v·ªõi 'received a bonus' (k·∫øt qu·∫£ r√µ r√†ng).",
                    "C. Achieved (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi hi·ªán t·∫°i 'this quarter' v·∫´n ƒëang trong th·ªùi gian hi·ªán t·∫°i.",
                    "D. Had been achieving (qu√° kh·ª© ho√†n th√†nh ti·∫øp di·ªÖn): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p ·ªü ƒë√¢y."
                ]
            },
            {
                level: "Intermediate",
                question: "Ms. Johnson ________ with several international clients lately, so she might be unavailable.",
                options: [
                    "A. has been meeting",
                    "B. meets",
                    "C. met",
                    "D. is meeting"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been meeting' v·ªõi 'lately' di·ªÖn t·∫£ c√°c cu·ªôc h·ªçp li√™n t·ª•c trong th·ªùi gian g·∫ßn ƒë√¢y, gi·∫£i th√≠ch t√¨nh tr·∫°ng hi·ªán t·∫°i (might be unavailable). Nh·∫•n m·∫°nh s·ª± l·∫∑p l·∫°i v√† li√™n t·ª•c.",
                whyWrong: [
                    "B. Meets (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen chung, kh√¥ng nh·∫•n m·∫°nh ho·∫°t ƒë·ªông tƒÉng c∆∞·ªùng 'lately'.",
                    "C. Met (qu√° kh·ª© ƒë∆°n): ch·ªâ s·ª± ki·ªán qu√° kh·ª©, kh√¥ng gi·∫£i th√≠ch t√¨nh tr·∫°ng hi·ªán t·∫°i.",
                    "D. Is meeting (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng ph√π h·ª£p v·ªõi 'lately' (kho·∫£ng th·ªùi gian r·ªông h∆°n)."
                ]
            },
            {
                level: "Intermediate",
                question: "The construction noise ________ me awake every night this week.",
                options: [
                    "A. has been keeping",
                    "B. kept",
                    "C. keeps",
                    "D. is keeping"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been keeping' di·ªÖn t·∫£ t√¨nh tr·∫°ng ti·∫øp di·ªÖn su·ªët tu·∫ßn n√†y ('this week' - kho·∫£ng th·ªùi gian ch∆∞a k·∫øt th√∫c). Present Perfect Continuous ph√π h·ª£p v·ªõi h√†nh ƒë·ªông l·∫∑p l·∫°i trong kho·∫£ng th·ªùi gian ƒë·∫øn hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Kept (qu√° kh·ª© ƒë∆°n): 'this week' ch∆∞a k·∫øt th√∫c n√™n kh√¥ng d√πng qu√° kh·ª© ƒë∆°n.",
                    "C. Keeps (hi·ªán t·∫°i ƒë∆°n): c√≥ th·ªÉ d√πng nh∆∞ng kh√¥ng nh·∫•n m·∫°nh s·ª± li√™n t·ª•c trong su·ªët tu·∫ßn nh∆∞ Present Perfect Continuous.",
                    "D. Is keeping (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t 'every night this week'."
                ]
            },
            {
                level: "Intermediate",
                question: "Our team ________ overtime to meet the deadline, but we still need more time.",
                options: [
                    "A. has been working",
                    "B. worked",
                    "C. works",
                    "D. had worked"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been working' nh·∫•n m·∫°nh n·ªó l·ª±c li√™n t·ª•c ƒë·∫øn hi·ªán t·∫°i, v√† 'but we still need' cho th·∫•y h√†nh ƒë·ªông v·∫´n li√™n quan ƒë·∫øn hi·ªán t·∫°i. Present Perfect Continuous ph√π h·ª£p ƒë·ªÉ n√≥i v·ªÅ n·ªó l·ª±c ch∆∞a ƒë·∫°t k·∫øt qu·∫£ mong mu·ªën.",
                whyWrong: [
                    "B. Worked (qu√° kh·ª© ƒë∆°n): ng·ª• √Ω ƒë√£ ng·ª´ng l√†m th√™m gi·ªù, kh√¥ng ph√π h·ª£p v·ªõi 'we still need more time'.",
                    "C. Works (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng nh·∫•n m·∫°nh n·ªó l·ª±c ƒë·∫∑c bi·ªát ƒë·ªÉ 'meet the deadline'.",
                    "D. Had worked (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p ·ªü ƒë√¢y."
                ]
            },
            {
                level: "Intermediate",
                question: "The company ________ its market share gradually over the last five years.",
                options: [
                    "A. has been increasing",
                    "B. has increased",
                    "C. increased",
                    "D. increases"
                ],
                correct: 1,
                explanation: "ƒê√∫ng! 'Has increased' nh·∫•n m·∫°nh K·∫æT QU·∫¢ (th·ªã ph·∫ßn ƒë√£ tƒÉng), trong khi 'gradually over the last five years' m√¥ t·∫£ qu√° tr√¨nh. V·ªõi ƒë·ªông t·ª´ tr·∫°ng th√°i nh∆∞ 'increase' (c√≥ th·ªÉ ƒëo l∆∞·ªùng), ta th∆∞·ªùng d√πng Present Perfect ƒë·ªÉ nh·∫•n m·∫°nh th√†nh t·ª±u.",
                whyWrong: [
                    "A. Has been increasing: c≈©ng ƒë√∫ng ng·ªØ ph√°p nh∆∞ng trong TOEIC, khi c√≥ k·∫øt qu·∫£ ƒëo l∆∞·ªùng r√µ r√†ng (market share), Present Perfect Simple ƒë∆∞·ª£c ∆∞a chu·ªông h∆°n.",
                    "C. Increased (qu√° kh·ª© ƒë∆°n): 'over the last five years' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "D. Increases (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ s·ª± th·∫≠t chung, kh√¥ng ph√π h·ª£p v·ªõi kho·∫£ng th·ªùi gian c·ª• th·ªÉ 'last five years'."
                ]
            },
            {
                level: "Intermediate",
                question: "Why is the office so messy? What ________ here?",
                options: [
                    "A. have you been doing",
                    "B. did you do",
                    "C. do you do",
                    "D. were you doing"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have you been doing' h·ªèi v·ªÅ h√†nh ƒë·ªông v·ª´a x·∫£y ra, c√≤n ƒë·ªÉ l·∫°i k·∫øt qu·∫£ ·ªü hi·ªán t·∫°i (messy office). Present Perfect Continuous d√πng ƒë·ªÉ h·ªèi v·ªÅ nguy√™n nh√¢n c·ªßa t√¨nh tr·∫°ng hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Did you do (qu√° kh·ª© ƒë∆°n): h·ªèi v·ªÅ h√†nh ƒë·ªông trong qu√° kh·ª© nh∆∞ng kh√¥ng nh·∫•n m·∫°nh k·∫øt qu·∫£ c√≤n l·∫°i ·ªü hi·ªán t·∫°i.",
                    "C. Do you do (hi·ªán t·∫°i ƒë∆°n): h·ªèi v·ªÅ th√≥i quen, kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng c·ª• th·ªÉ (office is messy now).",
                    "D. Were you doing (qu√° kh·ª© ti·∫øp di·ªÖn): h·ªèi v·ªÅ h√†nh ƒë·ªông ƒëang x·∫£y ra t·∫°i m·ªôt th·ªùi ƒëi·ªÉm qu√° kh·ª©, kh√¥ng li√™n h·ªá v·ªõi hi·ªán t·∫°i."
                ]
            },
            {
                level: "Advanced",
                question: "The research department ________ data from various sources, which should help us make an informed decision.",
                options: [
                    "A. has been collecting",
                    "B. has collected",
                    "C. had been collecting",
                    "D. collected"
                ],
                correct: 1,
                explanation: "ƒê√∫ng! 'Has collected' nh·∫•n m·∫°nh d·ªØ li·ªáu ƒê√É THU TH·∫¨P XONG v√† s·∫µn s√†ng ƒë·ªÉ ra quy·∫øt ƒë·ªãnh. 'Which should help' ch·ªâ k·∫øt qu·∫£ ho√†n th√†nh. N·∫øu d√πng 'has been collecting', ng·ª• √Ω v·∫´n ƒëang thu th·∫≠p, ch∆∞a s·∫µn s√†ng.",
                whyWrong: [
                    "A. Has been collecting: nh·∫•n m·∫°nh qu√° tr√¨nh v·∫´n ƒëang ti·∫øp di·ªÖn, kh√¥ng ph√π h·ª£p v·ªõi 'should help us make a decision' (c·∫ßn d·ªØ li·ªáu ƒë√£ c√≥).",
                    "C. Had been collecting (qu√° kh·ª© ho√†n th√†nh ti·∫øp di·ªÖn): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng h·ª£p l√Ω ·ªü ƒë√¢y.",
                    "D. Collected (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi hi·ªán t·∫°i (should help us now)."
                ]
            },
            {
                level: "Advanced",
                question: "By the time we launch the product, the team ________ on this project for over a year.",
                options: [
                    "A. will have been working",
                    "B. has been working",
                    "C. will work",
                    "D. works"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Will have been working' (t∆∞∆°ng lai ho√†n th√†nh ti·∫øp di·ªÖn) di·ªÖn t·∫£ h√†nh ƒë·ªông s·∫Ω k√©o d√†i cho ƒë·∫øn m·ªôt th·ªùi ƒëi·ªÉm trong t∆∞∆°ng lai (when we launch). 'By the time' l√† d·∫•u hi·ªáu c·ªßa Future Perfect Continuous.",
                whyWrong: [
                    "B. Has been working (hi·ªán t·∫°i ho√†n th√†nh ti·∫øp di·ªÖn): di·ªÖn t·∫£ h√†nh ƒë·ªông ƒë·∫øn hi·ªán t·∫°i, nh∆∞ng 'by the time we launch' ch·ªâ th·ªùi ƒëi·ªÉm t∆∞∆°ng lai.",
                    "C. Will work (t∆∞∆°ng lai ƒë∆°n): ch·ªâ h√†nh ƒë·ªông s·∫Ω x·∫£y ra, kh√¥ng nh·∫•n m·∫°nh kho·∫£ng th·ªùi gian 'over a year'.",
                    "D. Works (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, ho√†n to√†n sai ng·ªØ c·∫£nh t∆∞∆°ng lai."
                ]
            },
            {
                level: "Advanced",
                question: "The company's profits ________ steadily, despite the economic downturn affecting most competitors.",
                options: [
                    "A. have been rising",
                    "B. rise",
                    "C. rose",
                    "D. had risen"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been rising' di·ªÖn t·∫£ xu h∆∞·ªõng tƒÉng li√™n t·ª•c ƒë·∫øn hi·ªán t·∫°i, ƒë·∫∑c bi·ªát trong b·ªëi c·∫£nh kh√≥ khƒÉn ('despite downturn'). Present Perfect Continuous nh·∫•n m·∫°nh s·ª± li√™n t·ª•c v√† ƒë√°ng ch√∫ √Ω c·ªßa xu h∆∞·ªõng.",
                whyWrong: [
                    "B. Rise (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ s·ª± th·∫≠t chung, kh√¥ng nh·∫•n m·∫°nh xu h∆∞·ªõng ƒëang di·ªÖn ra.",
                    "C. Rose (qu√° kh·ª© ƒë∆°n): ch·ªâ s·ª± ki·ªán ƒë√£ x·∫£y ra, kh√¥ng n√≥i l√™n xu h∆∞·ªõng li√™n t·ª•c ƒë·∫øn hi·ªán t·∫°i.",
                    "D. Had risen (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p ·ªü ƒë√¢y."
                ]
            },
            {
                level: "Advanced",
                question: "Employees ________ about the lack of communication from management recently.",
                options: [
                    "A. have been complaining",
                    "B. complained",
                    "C. complain",
                    "D. are complaining"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been complaining' v·ªõi 'recently' di·ªÖn t·∫£ t√¨nh tr·∫°ng ph√†n n√†n li√™n t·ª•c trong th·ªùi gian g·∫ßn ƒë√¢y. Present Perfect Continuous th√≠ch h·ª£p cho h√†nh ƒë·ªông l·∫∑p l·∫°i nhi·ªÅu l·∫ßn trong m·ªôt kho·∫£ng th·ªùi gian ƒë·∫øn hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Complained (qu√° kh·ª© ƒë∆°n): 'recently' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect Continuous.",
                    "C. Complain (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen chung, kh√¥ng nh·∫•n m·∫°nh t√¨nh tr·∫°ng 'recently'.",
                    "D. Are complaining (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t 'recently'."
                ]
            },
            {
                level: "Advanced",
                question: "The manufacturing plant ________ at full capacity since the beginning of the year to meet increased demand.",
                options: [
                    "A. has been operating",
                    "B. operates",
                    "C. operated",
                    "D. will operate"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been operating' v·ªõi 'since the beginning of the year' di·ªÖn t·∫£ ho·∫°t ƒë·ªông li√™n t·ª•c t·ª´ ƒë·∫ßu nƒÉm ƒë·∫øn nay. 'Since' l√† d·∫•u hi·ªáu ƒëi·ªÉn h√¨nh c·ªßa Present Perfect Continuous, v√† 'at full capacity' nh·∫•n m·∫°nh c∆∞·ªùng ƒë·ªô li√™n t·ª•c.",
                whyWrong: [
                    "B. Operates (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông th√¥ng th∆∞·ªùng, kh√¥ng nh·∫•n m·∫°nh t√¨nh tr·∫°ng ƒë·∫∑c bi·ªát 'since the beginning of the year'.",
                    "C. Operated (qu√° kh·ª© ƒë∆°n): 'since the beginning of the year' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "D. Will operate (t∆∞∆°ng lai ƒë∆°n): sai ho√†n to√†n v√¨ ƒë√£ ho·∫°t ƒë·ªông t·ª´ ƒë·∫ßu nƒÉm."
                ]
            },
            {
                level: "Advanced",
                question: "Mr. Peterson ________ the same presentation to different departments all week, which explains why he looks exhausted.",
                options: [
                    "A. has been giving",
                    "B. gave",
                    "C. gives",
                    "D. is giving"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been giving' di·ªÖn t·∫£ h√†nh ƒë·ªông l·∫∑p l·∫°i nhi·ªÅu l·∫ßn su·ªët tu·∫ßn ('all week' - ch∆∞a k·∫øt th√∫c), gi·∫£i th√≠ch t√¨nh tr·∫°ng hi·ªán t·∫°i (looks exhausted). Perfect structure cho TOEIC 950+.",
                whyWrong: [
                    "B. Gave (qu√° kh·ª© ƒë∆°n): 'all week' (this week) ch∆∞a k·∫øt th√∫c n√™n c·∫ßn Present Perfect Continuous.",
                    "C. Gives (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng gi·∫£i th√≠ch ƒë∆∞·ª£c t√¨nh tr·∫°ng m·ªát m·ªèi b·∫•t th∆∞·ªùng.",
                    "D. Is giving (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t 'all week'."
                ]
            },
            {
                level: "Advanced",
                question: "Investors ________ confidence in the stock market lately due to political instability.",
                options: [
                    "A. have been losing",
                    "B. lose",
                    "C. lost",
                    "D. had lost"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been losing' v·ªõi 'lately' di·ªÖn t·∫£ xu h∆∞·ªõng m·∫•t d·∫ßn ni·ªÅm tin trong th·ªùi gian g·∫ßn ƒë√¢y. Present Perfect Continuous ph√π h·ª£p ƒë·ªÉ m√¥ t·∫£ xu h∆∞·ªõng/thay ƒë·ªïi d·∫ßn d·∫ßn ƒëang di·ªÖn ra.",
                whyWrong: [
                    "B. Lose (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ s·ª± th·∫≠t chung, kh√¥ng th·ªÉ hi·ªán xu h∆∞·ªõng 'lately'.",
                    "C. Lost (qu√° kh·ª© ƒë∆°n): 'lately' li√™n quan ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "D. Had lost (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p ·ªü ƒë√¢y."
                ]
            },
            {
                level: "Advanced",
                question: "The IT department ________ with network issues all morning, so some services may still be affected.",
                options: [
                    "A. has been dealing",
                    "B. dealt",
                    "C. deals",
                    "D. was dealing"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been dealing' di·ªÖn t·∫£ vi·ªác x·ª≠ l√Ω li√™n t·ª•c t·ª´ s√°ng ƒë·∫øn gi·ªù, gi·∫£i th√≠ch t·∫°i sao 'services may still be affected' (hi·ªán t·∫°i). Present Perfect Continuous k·∫øt n·ªëi qu√° kh·ª© v·ªõi hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Dealt (qu√° kh·ª© ƒë∆°n): ng·ª• √Ω ƒë√£ x·ª≠ l√Ω xong, kh√¥ng ph√π h·ª£p v·ªõi 'may still be affected'.",
                    "C. Deals (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ nhi·ªám v·ª• th√¥ng th∆∞·ªùng, kh√¥ng ph·∫£n √°nh t√¨nh hu·ªëng kh·∫©n c·∫•p 'all morning'.",
                    "D. Was dealing (qu√° kh·ª© ti·∫øp di·ªÖn): kh√¥ng li√™n k·∫øt v·ªõi hi·ªán t·∫°i (may still be affected now)."
                ]
            },
            {
                level: "Advanced",
                question: "Several employees ________ concerns about workplace safety, prompting management to schedule a meeting.",
                options: [
                    "A. have been raising",
                    "B. raised",
                    "C. raise",
                    "D. were raising"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been raising' di·ªÖn t·∫£ vi·ªác nhi·ªÅu nh√¢n vi√™n li√™n t·ª•c ƒë∆∞a ra lo ng·∫°i, d·∫´n ƒë·∫øn quy·∫øt ƒë·ªãnh h·ªçp (hi·ªán t·∫°i). Present Perfect Continuous cho th·∫•y h√†nh ƒë·ªông l·∫∑p l·∫°i nhi·ªÅu l·∫ßn trong th·ªùi gian g·∫ßn ƒë√¢y.",
                whyWrong: [
                    "B. Raised (qu√° kh·ª© ƒë∆°n): c√≥ th·ªÉ d√πng nh∆∞ng kh√¥ng nh·∫•n m·∫°nh t√≠nh li√™n t·ª•c v√† l·∫∑p l·∫°i nh∆∞ Present Perfect Continuous (ƒëi·ªÉm ph√¢n bi·ªát cho TOEIC 950+).",
                    "C. Raise (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng c·ª• th·ªÉ d·∫´n ƒë·∫øn 'prompting management'.",
                    "D. Were raising (qu√° kh·ª© ti·∫øp di·ªÖn): kh√¥ng li√™n k·∫øt v·ªõi quy·∫øt ƒë·ªãnh hi·ªán t·∫°i (to schedule a meeting)."
                ]
            },
            {
                level: "Advanced",
                question: "The consulting firm ________ its services to include digital transformation, which has attracted many new clients.",
                options: [
                    "A. has expanded",
                    "B. has been expanding",
                    "C. expanded",
                    "D. expands"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has expanded' nh·∫•n m·∫°nh K·∫æT QU·∫¢ ƒë√£ ho√†n th√†nh (d·ªãch v·ª• ƒë√£ ƒë∆∞·ª£c m·ªü r·ªông), d·∫´n ƒë·∫øn thu h√∫t kh√°ch h√†ng. V·ªõi ƒë·ªông t·ª´ thay ƒë·ªïi tr·∫°ng th√°i nh∆∞ 'expand' v√† k·∫øt qu·∫£ r√µ r√†ng, Present Perfect Simple ph√π h·ª£p h∆°n.",
                whyWrong: [
                    "B. Has been expanding: nh·∫•n m·∫°nh qu√° tr√¨nh ƒëang m·ªü r·ªông, nh∆∞ng 'which has attracted' cho th·∫•y vi·ªác m·ªü r·ªông ƒë√£ ho√†n th√†nh v√† c√≥ k·∫øt qu·∫£.",
                    "C. Expanded (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi k·∫øt qu·∫£ hi·ªán t·∫°i 'has attracted'.",
                    "D. Expands (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông th∆∞·ªùng xuy√™n, kh√¥ng ph√π h·ª£p v·ªõi s·ª± ki·ªán c·ª• th·ªÉ."
                ]
            },
            {
                level: "Advanced",
                question: "Analysts ________ the financial reports carefully before making their recommendations.",
                options: [
                    "A. have been reviewing",
                    "B. reviewed",
                    "C. review",
                    "D. had reviewed"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been reviewing' di·ªÖn t·∫£ vi·ªác xem x√©t c·∫©n th·∫≠n ƒëang di·ªÖn ra v√† ch∆∞a k·∫øt th√∫c, tr∆∞·ªõc khi ƒë∆∞a ra khuy·∫øn ngh·ªã (t∆∞∆°ng lai g·∫ßn). Present Perfect Continuous cho th·∫•y qu√° tr√¨nh chu·∫©n b·ªã v·∫´n ƒëang ti·∫øp di·ªÖn.",
                whyWrong: [
                    "B. Reviewed (qu√° kh·ª© ƒë∆°n): ng·ª• √Ω ƒë√£ xem x√©t xong, nh∆∞ng 'before making recommendations' cho th·∫•y qu√° tr√¨nh ch∆∞a ho√†n th√†nh.",
                    "C. Review (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng ph√π h·ª£p v·ªõi t√¨nh hu·ªëng c·ª• th·ªÉ n√†y.",
                    "D. Had reviewed (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p ·ªü ƒë√¢y."
                ]
            },
            {
                level: "Advanced",
                question: "The quality control team ________ stricter standards recently to improve customer satisfaction.",
                options: [
                    "A. has been implementing",
                    "B. implements",
                    "C. implemented",
                    "D. had implemented"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been implementing' v·ªõi 'recently' di·ªÖn t·∫£ qu√° tr√¨nh tri·ªÉn khai ti√™u chu·∫©n nghi√™m ng·∫∑t h∆°n ƒëang di·ªÖn ra. Present Perfect Continuous ph√π h·ª£p cho h√†nh ƒë·ªông b·∫Øt ƒë·∫ßu g·∫ßn ƒë√¢y v√† v·∫´n ti·∫øp t·ª•c.",
                whyWrong: [
                    "B. Implements (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng th·ªÉ hi·ªán s·ª± thay ƒë·ªïi 'recently'.",
                    "C. Implemented (qu√° kh·ª© ƒë∆°n): 'recently' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "D. Had implemented (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p."
                ]
            },
            {
                level: "Advanced",
                question: "We ________ positive feedback from customers since we redesigned the website.",
                options: [
                    "A. have been receiving",
                    "B. received",
                    "C. receive",
                    "D. are receiving"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been receiving' v·ªõi 'since we redesigned' di·ªÖn t·∫£ vi·ªác nh·∫≠n ph·∫£n h·ªìi li√™n t·ª•c t·ª´ khi thi·∫øt k·∫ø l·∫°i ƒë·∫øn nay. 'Since' l√† d·∫•u hi·ªáu r√µ r√†ng c·ªßa Present Perfect Continuous.",
                whyWrong: [
                    "B. Received (qu√° kh·ª© ƒë∆°n): 'since we redesigned' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "C. Receive (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông th√¥ng th∆∞·ªùng, kh√¥ng nh·∫•n m·∫°nh xu h∆∞·ªõng t·ª´ 'since we redesigned'.",
                    "D. Are receiving (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t kho·∫£ng th·ªùi gian t·ª´ 'since'."
                ]
            },
            {
                level: "Advanced",
                question: "The legal team ________ the contract terms for weeks, but negotiations are still ongoing.",
                options: [
                    "A. has been discussing",
                    "B. discussed",
                    "C. discusses",
                    "D. is discussing"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been discussing' v·ªõi 'for weeks' di·ªÖn t·∫£ th·∫£o lu·∫≠n k√©o d√†i nhi·ªÅu tu·∫ßn v√† 'are still ongoing' x√°c nh·∫≠n v·∫´n ti·∫øp di·ªÖn. Perfect structure cho TOEIC 950+ khi c√≥ c·∫£ kho·∫£ng th·ªùi gian v√† t√¨nh tr·∫°ng hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Discussed (qu√° kh·ª© ƒë∆°n): ng·ª• √Ω ƒë√£ ng·ª´ng th·∫£o lu·∫≠n, kh√¥ng ph√π h·ª£p v·ªõi 'are still ongoing'.",
                    "C. Discusses (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ th√≥i quen, kh√¥ng nh·∫•n m·∫°nh n·ªó l·ª±c 'for weeks'.",
                    "D. Is discussing (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t 'for weeks'."
                ]
            },
            {
                level: "Advanced",
                question: "Local suppliers ________ difficulty keeping up with our orders due to increased production.",
                options: [
                    "A. have been experiencing",
                    "B. experience",
                    "C. experienced",
                    "D. had experienced"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been experiencing' di·ªÖn t·∫£ kh√≥ khƒÉn li√™n t·ª•c ƒëang x·∫£y ra do s·∫£n xu·∫•t tƒÉng. Present Perfect Continuous ph√π h·ª£p cho t√¨nh tr·∫°ng ƒëang di·ªÖn ra v√† g√¢y ·∫£nh h∆∞·ªüng hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Experience (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ t√¨nh tr·∫°ng chung, kh√¥ng nh·∫•n m·∫°nh v·∫•n ƒë·ªÅ ƒëang di·ªÖn ra 'due to increased production'.",
                    "C. Experienced (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi t√¨nh tr·∫°ng hi·ªán t·∫°i.",
                    "D. Had experienced (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p."
                ]
            },
            {
                level: "Advanced",
                question: "The board ________ whether to approve the merger for several months now.",
                options: [
                    "A. has been considering",
                    "B. considered",
                    "C. considers",
                    "D. is considering"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been considering' v·ªõi 'for several months now' di·ªÖn t·∫£ vi·ªác c√¢n nh·∫Øc k√©o d√†i nhi·ªÅu th√°ng v√† v·∫´n ch∆∞a quy·∫øt ƒë·ªãnh. 'Now' nh·∫•n m·∫°nh li√™n quan ƒë·∫øn hi·ªán t·∫°i.",
                whyWrong: [
                    "B. Considered (qu√° kh·ª© ƒë∆°n): ng·ª• √Ω ƒë√£ k·∫øt th√∫c qu√° tr√¨nh c√¢n nh·∫Øc, kh√¥ng ph√π h·ª£p v·ªõi 'now'.",
                    "C. Considers (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông th∆∞·ªùng xuy√™n, kh√¥ng nh·∫•n m·∫°nh qu√° tr√¨nh k√©o d√†i 'for several months'.",
                    "D. Is considering (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra hi·ªán t·∫°i, kh√¥ng bao qu√°t 'for several months'."
                ]
            },
            {
                level: "Advanced",
                question: "Competitors ________ to enter our market segment, which requires us to strengthen our position.",
                options: [
                    "A. have been attempting",
                    "B. attempt",
                    "C. attempted",
                    "D. are attempting"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Have been attempting' di·ªÖn t·∫£ c√°c n·ªó l·ª±c li√™n t·ª•c c·ªßa ƒë·ªëi th·ªß trong th·ªùi gian g·∫ßn ƒë√¢y, d·∫´n ƒë·∫øn nhu c·∫ßu c·ªßng c·ªë v·ªã th·∫ø (hi·ªán t·∫°i). Present Perfect Continuous cho th·∫•y m·ªëi ƒëe d·ªça ƒëang di·ªÖn ra.",
                whyWrong: [
                    "B. Attempt (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông chung, kh√¥ng nh·∫•n m·∫°nh n·ªó l·ª±c gia tƒÉng g·∫ßn ƒë√¢y.",
                    "C. Attempted (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi nhu c·∫ßu hi·ªán t·∫°i 'requires us to strengthen'.",
                    "D. Are attempting (hi·ªán t·∫°i ti·∫øp di·ªÖn): ch·ªâ h√†nh ƒë·ªông ƒëang x·∫£y ra ngay b√¢y gi·ªù, kh√¥ng bao qu√°t xu h∆∞·ªõng k√©o d√†i."
                ]
            },
            {
                level: "Advanced",
                question: "The director ________ a more collaborative work environment since taking over the department.",
                options: [
                    "A. has been promoting",
                    "B. promoted",
                    "C. promotes",
                    "D. had promoted"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has been promoting' v·ªõi 'since taking over' di·ªÖn t·∫£ n·ªó l·ª±c li√™n t·ª•c t·ª´ khi nh·∫≠m ch·ª©c ƒë·∫øn nay. 'Since + V-ing' l√† c·∫•u tr√∫c ƒëi·ªÉn h√¨nh cho Present Perfect Continuous trong TOEIC 950+.",
                whyWrong: [
                    "B. Promoted (qu√° kh·ª© ƒë∆°n): 'since taking over' k√©o d√†i ƒë·∫øn hi·ªán t·∫°i n√™n c·∫ßn Present Perfect.",
                    "C. Promotes (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ ho·∫°t ƒë·ªông chung, kh√¥ng nh·∫•n m·∫°nh s·ª± thay ƒë·ªïi 'since taking over'.",
                    "D. Had promoted (qu√° kh·ª© ho√†n th√†nh): d√πng cho h√†nh ƒë·ªông tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©, kh√¥ng ph√π h·ª£p."
                ]
            },
            {
                level: "Advanced",
                question: "The marketing campaign ________ excellent results, exceeding all our expectations.",
                options: [
                    "A. has produced",
                    "B. has been producing",
                    "C. produced",
                    "D. produces"
                ],
                correct: 0,
                explanation: "ƒê√∫ng! 'Has produced' nh·∫•n m·∫°nh K·∫æT QU·∫¢ ƒë√£ ƒë·∫°t ƒë∆∞·ª£c (excellent results, exceeding expectations). Khi c√≥ k·∫øt qu·∫£ c·ª• th·ªÉ v√† r√µ r√†ng, Present Perfect Simple ph√π h·ª£p h∆°n Continuous.",
                whyWrong: [
                    "B. Has been producing: nh·∫•n m·∫°nh qu√° tr√¨nh ƒëang t·∫°o ra k·∫øt qu·∫£, nh∆∞ng 'exceeding all expectations' cho th·∫•y k·∫øt qu·∫£ ƒë√£ ƒë·∫°t ƒë∆∞·ª£c.",
                    "C. Produced (qu√° kh·ª© ƒë∆°n): kh√¥ng li√™n k·∫øt v·ªõi hi·ªán t·∫°i (k·∫øt qu·∫£ v·∫´n c√≤n gi√° tr·ªã).",
                    "D. Produces (hi·ªán t·∫°i ƒë∆°n): di·ªÖn t·∫£ kh·∫£ nƒÉng chung, kh√¥ng ph√π h·ª£p v·ªõi th√†nh t·ª±u c·ª• th·ªÉ."
                ]
            }
        ];

        let currentQuestion = 0;
        let answers = new Array(questions.length).fill(null);
        let score = 0;

        function loadQuestion() {
            const q = questions[currentQuestion];
            const levelBadge = document.getElementById('levelBadge');
            const questionEl = document.getElementById('question');
            const optionsEl = document.getElementById('options');
            const explanationEl = document.getElementById('explanation');
            
            levelBadge.textContent = q.level;
            levelBadge.className = 'level-badge level-' + q.level.toLowerCase();
            
            questionEl.textContent = `${currentQuestion + 1}. ${q.question}`;
            
            optionsEl.innerHTML = '';
            q.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                
                if (answers[currentQuestion] !== null) {
                    optionDiv.classList.add('disabled');
                    if (index === answers[currentQuestion]) {
                        optionDiv.classList.add('selected');
                        if (index === q.correct) {
                            optionDiv.classList.add('correct');
                        } else {
                            optionDiv.classList.add('incorrect');
                        }
                    }
                    if (index === q.correct && index !== answers[currentQuestion]) {
                        optionDiv.classList.add('correct');
                    }
                } else {
                    optionDiv.onclick = () => selectAnswer(index);
                }
                
                optionsEl.appendChild(optionDiv);
            });
            
            if (answers[currentQuestion] !== null) {
                showExplanation();
            } else {
                explanationEl.classList.remove('show');
            }
            
            updateProgress();
            updateNavButtons();
        }

        function selectAnswer(index) {
            if (answers[currentQuestion] !== null) return;
            
            answers[currentQuestion] = index;
            const q = questions[currentQuestion];
            
            const options = document.querySelectorAll('.option');
            options.forEach((opt, i) => {
                opt.classList.add('disabled');
                if (i === index) {
                    opt.classList.add('selected');
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else {
                        opt.classList.add('incorrect');
                    }
                }
                if (i === q.correct && i !== index) {
                    opt.classList.add('correct');
                }
            });
            
            showExplanation();
            updateNavButtons();
        }

        function showExplanation() {
            const q = questions[currentQuestion];
            const explanationEl = document.getElementById('explanation');
            const isCorrect = answers[currentQuestion] === q.correct;
            
            explanationEl.className = 'explanation show ' + (isCorrect ? 'correct-explanation' : 'incorrect-explanation');
            
            let html = `
                <h3>${isCorrect ? '‚úÖ Ch√≠nh x√°c!' : '‚ùå Ch∆∞a ch√≠nh x√°c'}</h3>
                <p><strong>ƒê√°p √°n ƒë√∫ng:</strong> ${q.options[q.correct]}</p>
                <p>${q.explanation}</p>
            `;
            
            if (q.whyWrong && q.whyWrong.length > 0) {
                html += `
                    <div class="why-wrong">
                        <h4>‚ùì T·∫°i sao c√°c ƒë√°p √°n kh√°c sai:</h4>
                        <ul>
                            ${q.whyWrong.map(reason => `<li>‚Ä¢ ${reason}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }
            
            explanationEl.innerHTML = html;
        }

        function updateProgress() {
            const answered = answers.filter(a => a !== null).length;
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            
            progressFill.style.width = (answered / questions.length * 100) + '%';
            progressText.textContent = `C√¢u ${currentQuestion + 1}/${questions.length} ‚Ä¢ ƒê√£ tr·∫£ l·ªùi: ${answered}/${questions.length}`;
        }

        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentQuestion === 0;
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = 'Ho√†n th√†nh ‚úì';
                nextBtn.className = 'nav-button finish-button';
            } else {
                nextBtn.textContent = 'C√¢u sau ‚Üí';
                nextBtn.className = 'nav-button next-button';
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            score = answers.filter((ans, idx) => ans === questions[idx].correct).length;
            const percentage = (score / questions.length * 100).toFixed(1);
            
            document.getElementById('quizCard').style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            
            const resultScreen = document.getElementById('resultScreen');
            const scoreCircle = document.getElementById('scoreCircle');
            const scoreText = document.getElementById('scoreText');
            const resultMessage = document.getElementById('resultMessage');
            const resultDetail = document.getElementById('resultDetail');
            
            scoreText.textContent = `${score}/${questions.length}`;
            resultDetail.textContent = `T·ª∑ l·ªá ch√≠nh x√°c: ${percentage}%`;
            
            if (percentage >= 90) {
                scoreCircle.className = 'score-circle score-excellent';
                resultMessage.textContent = 'üèÜ Xu·∫•t s·∫Øc! B·∫°n ƒë√£ s·∫µn s√†ng cho TOEIC 950+';
            } else if (percentage >= 75) {
                scoreCircle.className = 'score-circle score-good';
                resultMessage.textContent = 'üëç T·ªët! Ti·∫øp t·ª•c luy·ªán t·∫≠p ƒë·ªÉ ƒë·∫°t m·ª•c ti√™u';
            } else if (percentage >= 60) {
                scoreCircle.className = 'score-circle score-fair';
                resultMessage.textContent = 'üìö Kh√°! C·∫ßn √¥n l·∫°i c√°c ƒëi·ªÉm y·∫øu';
            } else {
                scoreCircle.className = 'score-circle score-poor';
                resultMessage.textContent = 'üí™ H√£y xem l·∫°i l√Ω thuy·∫øt v√† l√†m l·∫°i nh√©!';
            }
            
            resultScreen.classList.add('show');
        }

        function restartQuiz() {
            currentQuestion = 0;
            answers = new Array(questions.length).fill(null);
            score = 0;
            
            document.getElementById('quizCard').style.display = 'block';
            document.querySelector('.navigation').style.display = 'flex';
            document.getElementById('resultScreen').classList.remove('show');
            
            loadQuestion();
        }

        // Initialize
        window.onload = () => {
            loadQuestion();
        };
    </script>
</body>
</html>